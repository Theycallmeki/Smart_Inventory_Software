<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sales History</title>
    <link rel="stylesheet" href="/salesHistory.css" />
  </head>
  <body>
    <header class="fixed-header">
      <a href="/">Home</a>
      <a href="/item">Items</a>
      <a href="/admin">Admin Panel</a>
      <a href="/sales-history">Sales History</a>
      <a href="/prediction">Prediction</a>
      <a href="/pos">Pos Mode</a>

    </header>

    <div class="container">
      <h1>Sales History</h1>

      <div class="glass-card">
        <h2>Sales History</h2>
        <table id="salesTable">
          <thead>
            <tr>
              <th>Item Name</th>
              <th>Category</th>
              <th>Price</th>
              <th>Date</th>
              <th>Quantity Sold</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <script>
      async function fetchSalesHistory() {
        const res = await fetch("/api/sales-history");
        const sales = await res.json();
        const tbody = document.querySelector("#salesTable tbody");
        tbody.innerHTML = "";

        // sort by latest date
        sales.sort((a, b) => new Date(b.date) - new Date(a.date));

        sales.forEach((sale) => {
          tbody.innerHTML += `
            <tr>
              <td>${sale.Item.name}</td>
              <td>${sale.Item.category}</td>
              <td>${sale.Item.price}</td>
              <td>${sale.date}</td>
              <td>${sale.quantitySold}</td>
            </tr>
          `;
        });
      }

      fetchSalesHistory();
    </script>
  </body>
</html>
